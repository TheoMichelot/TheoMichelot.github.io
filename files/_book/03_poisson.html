<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Poisson processes – Stochastic Processes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_markov_continuous.html" rel="next">
<link href="./02_markov_discrete.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/rglWebGL-binding-1.3.1/rglWebGL.js"></script>
<link href="site_libs/rglwidgetClass-1.3.1/rgl.css" rel="stylesheet">
<script src="site_libs/rglwidgetClass-1.3.1/rglClass.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/utils.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/buffer.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/subscenes.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/shaders.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/shadersrc.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/textures.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/projection.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/mouse.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/init.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/pieces.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/draw.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/controls.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/selection.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/rglTimer.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/pretty.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/axes.src.js"></script>
<script src="site_libs/rglwidgetClass-1.3.1/animation.src.js"></script>
<script src="site_libs/CanvasMatrix4-1.3.1/CanvasMatrix.src.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_poisson.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Poisson processes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./cover_spiral.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Stochastic Processes</a> 
        <div class="sidebar-tools-main">
    <a href="./Stochastic-Processes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Background</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_markov_discrete.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Discrete-time Markov processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_poisson.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Poisson processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_markov_continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Continuous-time Markov processes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_HMM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hidden Markov models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-poisson-process" id="toc-the-poisson-process" class="nav-link active" data-scroll-target="#the-poisson-process"><span class="header-section-number">3.1</span> The Poisson process</a>
  <ul class="collapse">
  <li><a href="#definition-and-terminology" id="toc-definition-and-terminology" class="nav-link" data-scroll-target="#definition-and-terminology"><span class="header-section-number">3.1.1</span> Definition and terminology</a></li>
  <li><a href="#infinitesimal-definition" id="toc-infinitesimal-definition" class="nav-link" data-scroll-target="#infinitesimal-definition"><span class="header-section-number">3.1.2</span> Infinitesimal definition</a></li>
  </ul></li>
  <li><a href="#distribution-of-interarrival-times" id="toc-distribution-of-interarrival-times" class="nav-link" data-scroll-target="#distribution-of-interarrival-times"><span class="header-section-number">3.2</span> Distribution of interarrival times</a>
  <ul class="collapse">
  <li><a href="#memorylessness" id="toc-memorylessness" class="nav-link" data-scroll-target="#memorylessness"><span class="header-section-number">3.2.1</span> Memorylessness</a></li>
  <li><a href="#simulating-from-a-poisson-process" id="toc-simulating-from-a-poisson-process" class="nav-link" data-scroll-target="#simulating-from-a-poisson-process"><span class="header-section-number">3.2.2</span> Simulating from a Poisson process</a></li>
  </ul></li>
  <li><a href="#distribution-of-arrival-times" id="toc-distribution-of-arrival-times" class="nav-link" data-scroll-target="#distribution-of-arrival-times"><span class="header-section-number">3.3</span> Distribution of arrival times</a>
  <ul class="collapse">
  <li><a href="#marginal-distribution-of-s_n" id="toc-marginal-distribution-of-s_n" class="nav-link" data-scroll-target="#marginal-distribution-of-s_n"><span class="header-section-number">3.3.1</span> Marginal distribution of <span class="math inline">\(S_n\)</span></a></li>
  <li><a href="#conditional-joint-distribution-of-s_1-dots-s_n" id="toc-conditional-joint-distribution-of-s_1-dots-s_n" class="nav-link" data-scroll-target="#conditional-joint-distribution-of-s_1-dots-s_n"><span class="header-section-number">3.3.2</span> Conditional joint distribution of <span class="math inline">\(S_1, \dots, S_n\)</span></a></li>
  </ul></li>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link" data-scroll-target="#statistical-inference"><span class="header-section-number">3.4</span> Statistical inference</a></li>
  <li><a href="#non-homogeneous-poisson-process" id="toc-non-homogeneous-poisson-process" class="nav-link" data-scroll-target="#non-homogeneous-poisson-process"><span class="header-section-number">3.5</span> Non-homogeneous Poisson process</a></li>
  <li><a href="#merging-and-splitting-poisson-processes" id="toc-merging-and-splitting-poisson-processes" class="nav-link" data-scroll-target="#merging-and-splitting-poisson-processes"><span class="header-section-number">3.6</span> Merging and splitting Poisson processes</a>
  <ul class="collapse">
  <li><a href="#merging-poisson-processes" id="toc-merging-poisson-processes" class="nav-link" data-scroll-target="#merging-poisson-processes"><span class="header-section-number">3.6.1</span> Merging Poisson processes</a></li>
  <li><a href="#splitting-a-poisson-process" id="toc-splitting-a-poisson-process" class="nav-link" data-scroll-target="#splitting-a-poisson-process"><span class="header-section-number">3.6.2</span> Splitting a Poisson process</a></li>
  </ul></li>
  <li><a href="#problems" id="toc-problems" class="nav-link" data-scroll-target="#problems"><span class="header-section-number">3.7</span> Problems</a></li>
  <li><a href="#appendix-some-proofs" id="toc-appendix-some-proofs" class="nav-link" data-scroll-target="#appendix-some-proofs">Appendix: some proofs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Poisson processes</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!---
 -   I need to add example problems (in green callout boxes) throughout, inspired by problems/examples in textbooks.

-   Should I use the idea of a point process, rather than a counting process, at the beginning? It seems more general and useful for students to learn about, but most textbooks start with counting processes. Can I find a book that presents it as a point process first and foremost?

- Some examples: sports (e.g., goals follow a Poisson process; rate could change halfway through game after players change, for added complexity); people with a broken leg in someone's family (not sure if this works, what is the question?); times of a student's assignments; review requests;   
--->
<p>We now turn to a different type of stochastic process, called a counting process. A counting process is useful to model the number or timing of events of interest, e.g., births in a hospital, goals scored by a hockey team, or earthquakes in a region.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>A stochastic process <span class="math inline">\((N_t)_{t \geq 0}\)</span> is called a <strong>counting process</strong> if:</p>
<ol type="1">
<li><p>for any <span class="math inline">\(t \geq 0\)</span>, <span class="math inline">\(N_t \geq 0\)</span>;</p></li>
<li><p>for any <span class="math inline">\(t \geq 0\)</span>, <span class="math inline">\(N_t\)</span> is integer-valued;</p></li>
<li><p>for any <span class="math inline">\(0 \leq s \leq t\)</span>, <span class="math inline">\(N_s \leq N_t\)</span>.</p></li>
</ol>
<p>We interpret <span class="math inline">\(N_t\)</span> as the total number of events that have occurred by time <span class="math inline">\(t\)</span>.</p>
</div>
</div>
<p><strong>Remarks:</strong></p>
<ul>
<li><p>In the definition of a counting process, the time index <span class="math inline">\(t\)</span> is defined over a continuous rather than discrete space. We can make that explicit by writing <span class="math inline">\((N_t)_{t \geq 0}\)</span>, but sometimes we omit it and simply denote the process as <span class="math inline">\((N_t)\)</span>. We use the letter <span class="math inline">\(t\)</span> to denote continuous time, in contrast with <span class="math inline">\(n\)</span> for the discrete time index in the previous chapter.</p></li>
<li><p>Here, we use the term “events” in the common sense, rather than in the technical sense from probability theory.</p></li>
</ul>
<p><strong>Example:</strong> The graph in <a href="#fig-counting-process" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-counting-process</span></a> shows an example counting process.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-counting-process" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-counting-process-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-counting-process-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-counting-process-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Example of counting process.
</figcaption>
</figure>
</div>
</div>
</div>
<!-- =========================================== -->
<!-- ================= SECTION ================= -->
<!-- =========================================== -->
<section id="the-poisson-process" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="the-poisson-process"><span class="header-section-number">3.1</span> The Poisson process</h2>
<section id="definition-and-terminology" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="definition-and-terminology"><span class="header-section-number">3.1.1</span> Definition and terminology</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>We say that the stochastic process <span class="math inline">\((N_t)\)</span> has <strong>independent increments</strong> if, for any <span class="math inline">\(0 \leq q &lt; r \leq s &lt; t\)</span>, the random variables <span class="math inline">\(N_r - N_q\)</span> and <span class="math inline">\(N_t - N_s\)</span> are independent.</p>
<p>We say that the stochastic process <span class="math inline">\((N_t)\)</span> has <strong>stationary increments</strong> if, for any <span class="math inline">\(s, t &gt; 0\)</span>, the random variables <span class="math inline">\(N_t\)</span> and <span class="math inline">\(N_{s + t} - N_s\)</span> have the same distribution.</p>
</div>
</div>
<p>If the process <span class="math inline">\((N_t)\)</span> has independent and stationary increments, the random variable <span class="math inline">\(N_t - N_s\)</span> depends only on the length of the time interval <span class="math inline">\(t - s\)</span>, and not on the specific values of <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.3
</div>
</div>
<div class="callout-body-container callout-body">
<p>A counting process <span class="math inline">\((N_t)_{t \geq 0}\)</span> is called a <strong>Poisson process</strong> with rate <span class="math inline">\(\lambda &gt; 0\)</span> if:</p>
<ol type="1">
<li><p><span class="math inline">\(N_0 = 0\)</span>, i.e., no events have occurred yet at time 0;</p></li>
<li><p><span class="math inline">\((N_t)\)</span> has independent and stationary increments;</p></li>
<li><p><span class="math inline">\(N_t \sim \text{Poisson}(\lambda t)\)</span> for any <span class="math inline">\(t &gt; 0\)</span>, i.e., <span class="math display">\[
\Pr(N_t = n) = e^{-\lambda t} \frac{(\lambda t)^n}{n!},\quad \text{for } n \in \mathbb{N}.
\]</span></p></li>
</ol>
</div>
</div>
<p>There are at least three alternative definitions of the Poisson process, and we will discuss another one a little later.</p>
<p>From the definition of a Poisson process, we can see that the number of events over <em>any interval of length</em> <span class="math inline">\(t\)</span> follows a Poisson distribution with rate <span class="math inline">\(\lambda t\)</span>. Indeed, because the increments of the process are stationary, <span class="math inline">\(N_t\)</span> and <span class="math inline">\(N_{s + t} - N_s\)</span> have the same distribution for any <span class="math inline">\(s, t &gt; 0\)</span>, i.e., <span class="math display">\[
\Pr(N_{s + t} - N_s = n) = e^{-\lambda t} \frac{(\lambda t)^n}{n!},\quad \text{for } n \in \mathbb{N}.
\]</span></p>
<p>As a reminder, <a href="#fig-pois-pmf" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-pois-pmf</span></a> shows the probability mass function of the Poisson distribution for five different values of the rate parameter <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pois-pmf" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pois-pmf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-pois-pmf-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pois-pmf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Probability mass function of Poisson distribution for different values of the rate parameter <span class="math inline">\(\lambda\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The rate parameter <span class="math inline">\(\lambda\)</span> of the process controls how often events happen: larger values of <span class="math inline">\(\lambda\)</span> correspond to more frequent events. Remember that both the mean and variance of the Poisson distribution are equal to the rate parameter, so we know that, on average, <span class="math inline">\(\lambda t\)</span> events will take place in an interval of length <span class="math inline">\(t\)</span>. In other words, the number of events is proportional to the rate parameter (<span class="math inline">\(\lambda\)</span>) and to the length of the interval (<span class="math inline">\(t\)</span>). It is intuitive that, on average, more events should take place over a longer interval; for a Poisson process, we expect twice as many events over an interval twice as long, and so on. The interpretation of <span class="math inline">\(\lambda\)</span> is the average number of events over an interval of length 1.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Assume that the number of customers who arrive at Superstore follows a Poisson process with an average rate of <span class="math inline">\(\lambda = 2\)</span> customers per minute.</p>
<ol type="1">
<li><p>What is the probability that exactly 10 customers arrive in the next 3 minutes?</p>
<p>Let <span class="math inline">\(N_3\)</span> be the number of customers that arrive in the next 3 minutes. By definition of the Poisson process, <span class="math inline">\(N_3\)</span> follows a Poisson distribution with rate <span class="math inline">\(3 \lambda = 6\)</span>. Then, we have <span class="math display">\[
     \Pr(N_3 = 10) = e^{-6} \frac{6^{10}}{10 !} = 0.041
\]</span></p></li>
<li><p>What is the probability that at least 2 customers arrive in the next 30 seconds?</p>
<p>The number of customers in the next 30 seconds, <span class="math inline">\(N_{0.5}\)</span>, follows a Poisson distribution with rate <span class="math inline">\(0.5 \lambda = 1\)</span>, and so <span class="math display">\[
\begin{aligned}
     \Pr(N_{0.5} \geq 2) &amp; = 1 - \Pr(N_{0.5} &lt; 2) \\
         &amp; = 1 - \Pr(N_{0.5} = 0) - \Pr(N_{0.5} = 1) \\
         &amp; = 1 - e^{-1} \frac{1^0}{0 !} - e^{-1} \frac{1^1}{1 !} \\
         &amp; = 0.264
\end{aligned}
\]</span></p></li>
<li><p>What is the probability that the next customer will arrive within 15 seconds?</p>
<p>This is equivalent to the probability the number of customers arriving in the next 15 seconds, <span class="math inline">\(N_{0.25}\)</span>, is at least one. We know that <span class="math inline">\(N_{0.25}\)</span> follows a Poisson distribution with rate <span class="math inline">\(0.25 \lambda = 0.5\)</span>, so <span class="math display">\[
\begin{aligned}
     \Pr(N_{0.25} \geq 1) &amp; = 1 - \Pr(N_{0.25} = 0) \\
         &amp; = 1 - e^{-0.5} \frac{0.5^0}{0 !} \\
         &amp; = 0.393
\end{aligned}
\]</span></p></li>
<li><p>What is the probability that exactly 3 customers arrive in the first minute and exactly 10 customers arrive in the first three minutes?</p>
<p>Let <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_3\)</span> be the numbers of customers arriving in the first minute and in the first three minutes, respectively. These two random variables are not independent, but we can rephrase the question in terms of <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_3 - N_1\)</span> (the number of customers arriving in the second and third minutes), which are independent. We want the probability that <span class="math inline">\(N_1 = 3\)</span> and <span class="math inline">\(N_3 - N_1 = 7\)</span>, and we know that <span class="math inline">\(N_1 \sim \text{Poisson}(2)\)</span> and <span class="math inline">\(N_3 - N_1 \sim \text{Poisson}(4)\)</span>, so <span class="math display">\[
\begin{aligned}
     \Pr(N_1 = 3, N_3 = 10) &amp; = \Pr(N_1 = 3) \Pr(N_3 = 10 \mid N_1 = 3) \\
         &amp; = \Pr(N_1 = 3) \Pr(N_3 - N_1 = 7 \mid N_1 = 3) \\
         &amp; = \Pr(N_1 = 3) \Pr(N_3 - N_1 = 7) \\
         &amp; = e^{-2} \frac{2^3}{3 !} \times e^{-4} \frac{4^7}{7 !} \\
         &amp; = 0.011
\end{aligned}
\]</span></p></li>
</ol>
</div>
</div>
</div>
<p>In many contexts, the variable of interest is not the number of events <span class="math inline">\(N_t\)</span>, but the times at which events occur, and the lengths of time intervals between events (e.g., expected time between two high-magnitude earthquakes in a region). For example, we might be interested in the times between events, denoted as <span class="math inline">\(T_1, T_2, \dots\)</span> in <a href="#fig-interarrival-times" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-interarrival-times</span></a>, or in the times of events, denoted as <span class="math inline">\(S_1, S_2, \dots\)</span> in <a href="#fig-interarrival-times" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-interarrival-times</span></a>. These random variables are called “interarrival times” and “arrival times”, respectively.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-interarrival-times" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interarrival-times-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-interarrival-times-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interarrival-times-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Illustration of interarrival times <span class="math inline">\(T_1, T_2, \dots\)</span> and arrival times <span class="math inline">\(S_1, S_2, \dots\)</span> of a Poisson process.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.4
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>interarrival times</strong> of a Poisson process are the random variables measuring the lengths of time intervals between successive events. We denote as <span class="math inline">\(T_n\)</span> the inter-arrival time between the <span class="math inline">\((n-1)^\text{th}\)</span> and the <span class="math inline">\(n^\text{th}\)</span> events (where <span class="math inline">\(T_1\)</span> is the time of the first event).</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.5
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>arrival times</strong> of a Poisson process are the times at which events occur. We denote as <span class="math inline">\(S_n\)</span> the arrival time for the <span class="math inline">\(n^\text{th}\)</span> event, i.e., <span class="math inline">\(S_n = T_1 + T_2 + \dots + T_n\)</span>.</p>
</div>
</div>
<p>The terminology of “arrivals” comes from queueing theory, where the focus is on modelling the arrivals and departures of customers from a queue. The interarrival times are also sometimes called “waiting times”, and the arrival times are sometimes called “event times”.</p>
</section>
<section id="infinitesimal-definition" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="infinitesimal-definition"><span class="header-section-number">3.1.2</span> Infinitesimal definition</h3>
<p>An alternative definition of the Poisson process describes the distribution of points over infinitesimal time intervals. It requires the little-o notation, and we first define this. We write <span class="math inline">\(f(h) = o(h)\)</span> (read as “little-o of <span class="math inline">\(h\)</span>”), if <span class="math display">\[
    \lim_{h \to 0} \frac{f(h)}{h} = 0.
\]</span> That is, we use <span class="math inline">\(o(h)\)</span> to denote any terms that are small relative to <span class="math inline">\(h\)</span> when <span class="math inline">\(h \to 0\)</span>, in the technical sense described above. Note that the little-o notation is only meaningful for a given limit (here, <span class="math inline">\(h \to 0\)</span>), and you should keep this in mind when reading the following definition.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.6 (alternative definition of Poisson process)
</div>
</div>
<div class="callout-body-container callout-body">
<p>The counting process <span class="math inline">\((N_t)_{t \geq 0}\)</span> is a <strong>Poisson process</strong> with rate <span class="math inline">\(\lambda &gt; 0\)</span> if</p>
<ol type="1">
<li><p><span class="math inline">\(N_0 = 0\)</span>;</p></li>
<li><p><span class="math inline">\((N_t)\)</span> has independent increments;</p></li>
<li><p><span class="math inline">\(\Pr(N_{t + h} - N_t = 1) = \lambda h + o(h)\)</span>;</p></li>
<li><p><span class="math inline">\(\Pr(N_{t + h} - N_t &gt; 1) = o(h)\)</span>.</p></li>
</ol>
</div>
</div>
<p>We will not prove the equivalence of the two definitions, but it turns out that these conditions imply that the count of events over a time interval follows a Poisson distribution.</p>
<p>Some books present all continuous-time stochastic processes using the little-o notation, so it is good to understand the intuition behind it. Essentially, condition 4 ensures that there cannot be more than one event in a very short time interval (or at least, the probability of that happening is negligible). Condition 3 states that the probability of an event occurring over a short time interval is approximately proportional to the rate parameter of the process, <span class="math inline">\(\lambda\)</span>.</p>
</section>
</section>
<section id="distribution-of-interarrival-times" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="distribution-of-interarrival-times"><span class="header-section-number">3.2</span> Distribution of interarrival times</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a Poisson process <span class="math inline">\((N_t)\)</span> with rate parameter <span class="math inline">\(\lambda &gt; 0\)</span>. The interarrival times of <span class="math inline">\((N_t)\)</span> (<span class="math inline">\(T_1, T_2, \dots\)</span>) are independent exponentially distributed random variables with rate parameter <span class="math inline">\(\lambda\)</span>. That is, they have the probability distribution function <span class="math inline">\(f(t) = \lambda e^{-\lambda t}\)</span>, for <span class="math inline">\(t \geq 0\)</span>.</p>
</div>
</div>
<!-- (Adapted from Korosteleva book, this doesn't prove independence though...) -->
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first prove the result for <span class="math inline">\(T_1\)</span>, the time of the first event. We have <span class="math inline">\(\Pr(T_1 &gt; t) = \Pr(N_t = 0) = e^{-\lambda t}\)</span>. We recognise the cumulative distribution function of the exponential distribution, so <span class="math inline">\(T_1 \sim \text{Exp}(\lambda)\)</span>.</p>
<p>Then, we turn to <span class="math inline">\(T_{n+1}\)</span>, the interarrival time between the <span class="math inline">\(n^\text{th}\)</span> and the <span class="math inline">\((n+1)^\text{th}\)</span> events, for <span class="math inline">\(n \geq 1\)</span>: <span class="math display">\[
\begin{aligned}
\Pr(T_{n+1} &gt; t) &amp; = \int_0^\infty \Pr(T_{n+1} &gt; t \mid S_n = s) f_{S_n}(s)\ ds  &amp;&amp; \text{(a)}\\
&amp; = \int_0^\infty \Pr(N_{s + t} - N_s = 0 \mid N_s = n) f_{S_n}(s)\ ds &amp;&amp; \text{(b)} \\
&amp; = \int_0^\infty \Pr(N_t = 0) f_{S_n}(s)\ ds  &amp;&amp; \text{(c)} \\
&amp; = e^{-\lambda t}\int_0^\infty f_{S_n} (s)\ ds  &amp;&amp; \text{(d)}\\
&amp; = e^{-\lambda t}, &amp;&amp; \text{(e)}
\end{aligned}
\]</span> showing that <span class="math inline">\(T_{n+1}\)</span> follows an exponential distribution with rate <span class="math inline">\(\lambda\)</span>. In the derivation above, (a) is the continuous version of the law of total probability, (b) translates a statement about interarrival times <span class="math inline">\((T_n)\)</span> to be in terms of counts <span class="math inline">\((N_t)\)</span>, (c) uses the stationarity and independence of increments in a Poisson process, (d) substitutes the probability mass function of the Poisson distribution, and (e) follows from the fact that probability density functions integrate to 1 (including <span class="math inline">\(f_{S_n}\)</span>).</p>
</div>
</div>
</div>
<p>The exponential distribution has a mode of zero, and a mean of <span class="math inline">\(1/\lambda\)</span>. This is consistent with our intuition of the Poisson process: the higher the rate, the shorter the interarrival times. The exponential distribution is illustrated in <a href="#fig-exp-pdf" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-exp-pdf</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-exp-pdf" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exp-pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-exp-pdf-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exp-pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Probability density function of exponential distribution for different values of the rate parameter <span class="math inline">\(\lambda\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="memorylessness" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="memorylessness"><span class="header-section-number">3.2.1</span> Memorylessness</h3>
<p>The above result on the distribution of interarrival times is important because the exponential distribution is the only continuous distribution with the memorylessness property.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.7
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable <span class="math inline">\(X\)</span> is <strong>memoryless</strong> if, for all <span class="math inline">\(s, t &gt; 0\)</span>, <span class="math display">\[
\Pr(X &gt; t + s \mid X &gt; t) = \Pr(X &gt; s).
\]</span></p>
</div>
</div>
<p>Because the interarrival times (<span class="math inline">\(T_1, T_2, \dots\)</span>) of a Poisson process follow an exponential distribution, they have the memoryless property, and so we have <span class="math display">\[
\Pr(T_n &gt; t + s \mid T_n &gt; t) = \Pr(T_n &gt; s),
\]</span> for all <span class="math inline">\(s, t &gt; 0\)</span>. In words, this means that, regardless of how long we have been waiting since the last event (which occurred at time <span class="math inline">\(t\)</span>), the distribution of the time we still need to wait until the next event is the same as the distribution of the original waiting time.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Assume that a bakery has on average 6 customers per hour, and that the interarrival times between customers follow an exponential distribution (with rate parameter <span class="math inline">\(\lambda = 6\)</span>). The mean interarrival time is <span class="math inline">\(1/6\)</span> hour = 10 minutes. Let’s say that the last customer came 30 minutes ago. This is an unusually long waiting time, so we might expect that the next customer is likely to arrive in the next few minutes, but this would be incorrect. In fact, regardless of the 30-minute wait, the distribution of the waiting time until the next customer arrives is still an exponential distribution with mean 10 minutes. This is because different customers arrive at the bakery independently, and the arrival of the next customer does not depend on the last customer.<br>
</p></li>
<li><p>A physical example of memorylessness is radioactive decay. Carbon-14 atoms decay into Nitrogen-14 over time, which takes 8267 years on average (this is called the “mean-life” of Carbon-14). For a given atom, time until decay follows an exponential distribution with rate parameter <span class="math inline">\(\lambda = 1/8267\)</span>. The probability that the atom decays in the next year does not depend on its age.</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="simulating-from-a-poisson-process" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="simulating-from-a-poisson-process"><span class="header-section-number">3.2.2</span> Simulating from a Poisson process</h3>
<p>The exponential distribution of interarrival times give us a convenient way to simulate from a Poisson process, based on the following algorithm. We initialise <span class="math inline">\(S_0 = 0\)</span> and, for <span class="math inline">\(n = 1, 2, \dots\)</span>,</p>
<ol type="1">
<li><p>generate an interarrival time <span class="math inline">\(T_n\)</span> from the exponential distribution;</p></li>
<li><p>compute the arrival time <span class="math inline">\(S_n = S_{n - 1} + T_n\)</span>;</p></li>
<li><p>let <span class="math inline">\(N_t = n - 1\)</span> for <span class="math inline">\(S_{n - 1} \leq t &lt; S_n\)</span>.</p></li>
</ol>
<p>In practice, we simulate the interarrival and the arrival times (e.g., using <code>rexp()</code> in R), and store those. Then, for a given time <span class="math inline">\(t\)</span>, we find the corresponding value of the Poisson process (<span class="math inline">\(n\)</span>) by looking for the two successive arrival times <span class="math inline">\(S_n\)</span> and <span class="math inline">\(S_{n+1}\)</span> such that <span class="math inline">\(S_{n} \leq t &lt; S_{n + 1}\)</span>. <a href="#fig-sim-pois-process" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-sim-pois-process</span></a> shows four example realisations of a Poisson process with rate parameter <span class="math inline">\(\lambda = 0.8\)</span> over <span class="math inline">\(0 \leq t \leq 10\)</span>, simulated using this algorithm.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-sim-pois-process" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sim-pois-process-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-sim-pois-process-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sim-pois-process-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.5: Four realisations of a Poisson process with rate <span class="math inline">\(\lambda = 0.8\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The following R chunk shows some example code that could be used to simulate from that Poisson process, and to find the count <span class="math inline">\(N_t\)</span> based on the sequence of simulated arrival times. This code could easily be modified to change the rate, the time window, or the number of realisations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">652</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a few parameters</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop until reaching tmax</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(times[<span class="fu">length</span>(times)] <span class="sc">&lt;</span> tmax) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    interarrival_time <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">rate =</span> rate)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    arrival_time <span class="ot">&lt;-</span> times[<span class="fu">length</span>(times)] <span class="sc">+</span> interarrival_time </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    times <span class="ot">&lt;-</span> <span class="fu">c</span>(times, arrival_time)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove 0, which is not an event time</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> times[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>times</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  2.518512  2.917831  3.395475  3.457126  3.612453  4.286739  6.602555
 [8]  8.107993  8.785203  8.862875 10.029713</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get event count in [0, 5] from arrival times</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(times <span class="sc">&lt;</span> <span class="dv">5</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
</section>
</section>
<section id="distribution-of-arrival-times" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="distribution-of-arrival-times"><span class="header-section-number">3.3</span> Distribution of arrival times</h2>
<p>There are two different results about the distribution of arrival times in a Poisson process: the distribution of one arrival time <span class="math inline">\(S_n\)</span>, and the joint distribution of all arrival times conditional on the number of events.</p>
<section id="marginal-distribution-of-s_n" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="marginal-distribution-of-s_n"><span class="header-section-number">3.3.1</span> Marginal distribution of <span class="math inline">\(S_n\)</span></h3>
<p>We first present a basic result about the distribution of the sum of independent random variables, which uses an operation called the convolution of two functions.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> be two independent continuous random variables, and <span class="math inline">\(Z = X + Y\)</span>. The probability density function of <span class="math inline">\(Z\)</span> is <span class="math display">\[
    f_Z(z) = \int_{-\infty}^\infty f_X(z - y) f_Y(y)\ dy.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By the law of total probability, <span class="math display">\[
\begin{aligned}
    f(Z = z) &amp; = \int_{-\infty}^\infty f(Z = z, Y = y)\ dy \\
    &amp; =  \int_{-\infty}^\infty f(X + Y = z, Y = y)\ dy \\
    &amp; = \int_{-\infty}^\infty f(X = z - y, Y = y)\ dy \\
    &amp; = \int_{-\infty}^\infty f(X = z - y) f(Y = y)\ dy
\end{aligned}
\]</span></p>
</div>
</div>
</div>
<p>The intuition behind this formula is that we consider every possible combination of values for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> that would yield <span class="math inline">\(Z = z\)</span>. Because <span class="math inline">\(Z\)</span> is defined as the sum of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we know that, if <span class="math inline">\(Z = z\)</span> and <span class="math inline">\(Y = y\)</span>, then we must have <span class="math inline">\(X = z - y\)</span>. So, to go through all possible combinations, we integrate (“sum”) over all possible values for <span class="math inline">\(Y\)</span>, and this also determines the value of <span class="math inline">\(X\)</span>. This is illustrated visually in Grant Sanderson’s Youtube video <a href="https://www.youtube.com/watch?v=IaSGqQa5O-M">“Convolutions | Why X+Y in probability is a beautiful mess”</a>. A similar result applies in the case of two discrete random variables, with a sum instead of an integral.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a Poisson process with parameter <span class="math inline">\(\lambda\)</span>, and let <span class="math inline">\(S_n\)</span> be the <span class="math inline">\(n^\text{th}\)</span> arrival time for that process. Then, <span class="math inline">\(S_n \sim \text{gamma}(n, \lambda)\)</span>, where <span class="math inline">\(n\)</span> is called the shape parameter, and <span class="math inline">\(\lambda\)</span> the rate parameter of the gamma distribution. That is, the probability density function of <span class="math inline">\(S_n\)</span> is <span class="math display">\[
f_{S_n}(t) = \frac{\lambda^n t^{n-1}}{(n-1)!} e^{-\lambda t},\quad \text{for } t &gt; 0.
\]</span></p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By definition, <span class="math inline">\(S_n = T_1 + T_2 + \dots + T_n\)</span> is the sum of <span class="math inline">\(n\)</span> independent random variables that all follow an exponential distribution with rate parameter <span class="math inline">\(\lambda\)</span>. We can use a proof by induction to show that a random variable defined by this sum follows a gamma distribution with shape <span class="math inline">\(n\)</span> and rate <span class="math inline">\(\lambda\)</span>.<br>
</p>
<ol type="1">
<li><p><strong>Base case:</strong> Show that this holds for <span class="math inline">\(n = 1\)</span>.</p>
<p>We have <span class="math inline">\(S_1 = T_1\)</span>, and we know that <span class="math inline">\(T_1 \sim Exp(\lambda)\)</span>, so <span class="math display">\[
     f_{S_1}(s) = f_{T_1}(s) = \lambda e^{-\lambda s},
\]</span> and this can be under the form of a gamma density function as <span class="math display">\[
     f_{S_1}(s) = \frac{\lambda^n e^{-\lambda s} s^{n - 1}}{(n - 1)!},\quad \text{where } n = 1.
\]</span></p>
<p>That is, <span class="math inline">\(S_1 \sim \text{gamma}(1, \lambda)\)</span>, so the hypothesis stands for <span class="math inline">\(n = 1\)</span>.<br>
</p></li>
<li><p><strong>Induction step:</strong> Show that, if <span class="math inline">\(S_{n - 1} \sim \text{gamma}(n - 1, \lambda)\)</span>, then <span class="math inline">\(S_n = S_{n-1} + T_n \sim \text{gamma}(n, \lambda)\)</span>.</p>
<p>By assumption, we have <span class="math display">\[
     f_{S_{n-1}}(s) = \frac{\lambda^{n-1} e^{-\lambda s} s^{n - 2}}{(n - 2)!},\quad \text{and } f_{T_n}(t) = \lambda e^{-\lambda t}.
\]</span></p>
<p>If we define <span class="math inline">\(S_n = S_{n-1} + T_n\)</span>, we can derive its density function by convolution, <span class="math display">\[
f_{S_n} (s) = \int_0^s f_{S_{n-1}}(z) f_{T_n} (s - z) dz
\]</span> where the domain of integration is <span class="math inline">\([0, s]\)</span> because <span class="math inline">\(f_{S_{n-1}}\)</span> and <span class="math inline">\(f_{T_n}\)</span> both have positive support (i.e., they are zero when the argument is negative). So, we have <span class="math display">\[
\begin{aligned}
     f_{S_n} (s) &amp; = \int_0^s \frac{\lambda^{n - 1} e^{-\lambda z} z^{n - 2}}{(n - 2)!} \lambda e^{-\lambda (s - z)} dz \\
             &amp; = \frac{\lambda^n e^{-\lambda s}}{(n - 2)!} \int_0^s z^{n - 2} dz \\
             &amp; = \frac{\lambda^n e^{-\lambda s}}{(n - 2)!} \left[ \frac{z^{n-1}}{n-1} \right]_0^s \\
             &amp; = \frac{\lambda^n e^{-\lambda s}}{(n - 2)!} \left( \frac{s^{n-1}}{n-1} - 0 \right) \\
             &amp; = \frac{\lambda^{n} e^{-\lambda s} s^{n-1}}{(n - 1)!}
\end{aligned}
\]</span> which is the density function of a gamma distribution with shape <span class="math inline">\(n\)</span> and rate <span class="math inline">\(\lambda\)</span>, as required.</p></li>
</ol>
</div>
</div>
</div>
<p>The mean and variance of the gamma distribution can be conveniently expressed in terms of the shape and rate parameters, so we also have that <span class="math display">\[
E[S_n] = \frac{n}{\lambda}\quad \text{and}\quad Var[S_n] = \frac{n}{\lambda^2}.
\]</span> That is, the expected value for the time <span class="math inline">\(n^\text{th}\)</span> event is proportional to <span class="math inline">\(n\)</span> and inversely proportional to <span class="math inline">\(\lambda\)</span>.</p>
<p><a href="#fig-gamma-pdf" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-gamma-pdf</span></a> shows the probability density function of the gamma distribution for several combinations of the shape <span class="math inline">\(n\)</span> and rate <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gamma-pdf" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamma-pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-gamma-pdf-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gamma-pdf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.6: Probability density function of gamma distribution for different parameter values.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In this context, the shape parameter must be a positive integer (<span class="math inline">\(n \in \mathbb{R}_{&gt;0}\)</span>); when this is the case, the gamma distribution is sometimes called the Erlang distribution. Note that, generally, the shape of the gamma distribution can be any positive real number, and the <span class="math inline">\((n - 1)!\)</span> in the denominator of the probability density function is replaced by the Gamma function <span class="math inline">\(\Gamma(n)\)</span> (which generalises the factorial to non-integers), but this is not needed in the present context.</p>
</section>
<section id="conditional-joint-distribution-of-s_1-dots-s_n" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="conditional-joint-distribution-of-s_1-dots-s_n"><span class="header-section-number">3.3.2</span> Conditional joint distribution of <span class="math inline">\(S_1, \dots, S_n\)</span></h3>
<p>We then turn to the joint distribution of arrival times over <span class="math inline">\((0, t)\)</span> conditional on the number of events <span class="math inline">\(n\)</span> in that interval. We must first define the concept of order statistic. If <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> are <span class="math inline">\(n\)</span> random variables, we call <span class="math inline">\(X_{(1)}, X_{(2)}, \dots, X_{(n)}\)</span> the corresponding order statistics if <span class="math inline">\(X_{(k)}\)</span> is the <span class="math inline">\(k^\text{th}\)</span> smallest value among the <span class="math inline">\(\{ X_k \}\)</span>. That is, the order statistics are the random variables in increasing order. If the <span class="math inline">\(\{X_k\}\)</span> are independent and identically distributed random variables with probability density function <span class="math inline">\(f_X\)</span>, then the joint density of the order statistics <span class="math inline">\(\{ X_{(k)} \}\)</span> is <span class="math display">\[
f_{X_{(1)}, \dots, X_{(n)}}(x_1, \dots, x_n) = n! \prod_{i = 1}^n f_X(x_i),\quad \text{where } x_1 &lt; x_2 &lt; \dots &lt; x_n.
\]</span> In particular, if the <span class="math inline">\(\{X_k\}\)</span> are independent and uniformly distributed over the interval <span class="math inline">\((0, t)\)</span>, the joint density of the corresponding order statistics is <span class="math display">\[
f_{X_{(1)}, \dots, X_{(n)}}(x_1, \dots, x_n) = \frac{n!}{t^n},\quad \text{where } 0 &lt; x_1 &lt; x_2 &lt; \dots &lt; x_n &lt; t.
\]</span></p>
<p>The reason that the <span class="math inline">\(n!\)</span> factor appears is that there are <span class="math inline">\(n!\)</span> combinations of the unordered variables that give rise to a given ordered sequence <span class="math inline">\(x_1, x_2, \dots, x_n\)</span> (the <span class="math inline">\(n!\)</span> permutations of <span class="math inline">\(x_1, x_2, \dots, x_n\)</span>). It might seem odd that the joint probability density function of <span class="math inline">\(n\)</span> uniform variables can be multiplied by <span class="math inline">\(n!\)</span> and still give rise to a valid probability density function. This is because, when the variables are ordered, this decreases the domain of the distribution (over which the density is non-zero) by a factor <span class="math inline">\(n!\)</span>. This is illustrated in two dimensions in <a href="#fig-order-stat-2d" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-order-stat-2d</span></a>, where the domain of the distribution is divided by two, and in three dimensions in the interactive plot below (which will unfortunately only show in the HTML version of the notes, not the PDF file).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-order-stat-2d" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-order-stat-2d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-order-stat-2d-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-order-stat-2d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.7: Simulation of order statistics corresponding to two independent uniform variables.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-webgl="true">
<div class="cell-output cell-output-stderr">
<pre><code>This build of rgl does not include OpenGL functions.  Use
 rglwidget() to display results, e.g. via options(rgl.printRglwidget = TRUE).</code></pre>
</div>
<div id="rgl50703" style="width:100%;height:650px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl50703-aria"></div>
<script type="application/json" data-for="rgl50703">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":1,"objects":{"7":{"id":7,"type":"points","material":{"lit":false},"vertices":"0","colors":"1","centers":"2","ignoreExtent":false,"flags":34816},"8":{"id":8,"type":"lines","material":{"lit":false},"vertices":"3","colors":"4","centers":"5","ignoreExtent":true,"flags":32832},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{},"colors":"6","centers":"7","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines"},"colors":"8","centers":"9","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"1":{"id":1,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.120401382446289],"modelMatrix":[[1,0,0,-0.4590150415897369],[0,0.3420201539993286,0.9396926164627075,-0.6889890432357788],[0,-0.9396926164627075,0.3420201539993286,-2.826752185821533],[0,0,0,1]],"projMatrix":[[3.732050895690918,0,0,0],[0,3.732050895690918,0,0],[0,0,-3.863703727722168,-11.24868583679199],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201433256682,0.9396926207859085,0],[0,-0.9396926207859085,0.3420201433256682,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0.0001087530981749296,0.9179213047027588,0.02480271831154823,0.9983733892440796,0.09457273781299591,0.9994352459907532],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NA","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,7,8,5],"subscenes":[],"flags":35136}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":480,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":1000,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5126,"count":1000,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":24,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":12,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":8,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":9,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":12000,"byteOffset":0},{"buffer":0,"byteLength":4,"byteOffset":12000},{"buffer":0,"byteLength":12000,"byteOffset":12004},{"buffer":0,"byteLength":288,"byteOffset":24004},{"buffer":0,"byteLength":4,"byteOffset":24292},{"buffer":0,"byteLength":144,"byteOffset":24296},{"buffer":0,"byteLength":16,"byteOffset":24440},{"buffer":0,"byteLength":3,"byteOffset":24456},{"buffer":0,"byteLength":4,"byteOffset":24459},{"buffer":0,"byteLength":3,"byteOffset":24463}],"buffers":[{"byteLength":24466,"bytes":"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\nAQAAAA=="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
<p>We can use the concept of order statistic to desribe the joint conditional distribution of the arrival times of a Poisson process.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.4
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a Poisson process <span class="math inline">\((N_t)\)</span>, and let <span class="math inline">\(S_n\)</span> be the <span class="math inline">\(n^\text{th}\)</span> arrival time for that process. Given that <span class="math inline">\(N_t = n\)</span>, the <span class="math inline">\(n\)</span> arrival times <span class="math inline">\(S_1, S_2, \dots, S_n\)</span> are distributed as the order statistics of a uniform distribution on <span class="math inline">\((0, t)\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The proof requires the derivation of the joint probability density of <span class="math inline">\(\{ S_1, \dots, S_n, N_t\}\)</span>, which we can rewrite in terms of the distributions of interarrival times <span class="math inline">\(T_1, \dots, T_n\)</span>. If the arrival times are <span class="math inline">\(S_1 = s_1, \dots, S_n = s_n\)</span> and the number of events is <span class="math inline">\(N_t = n\)</span>, then we know that the <span class="math inline">\(n\)</span> first interarrival times are <span class="math inline">\(T_1 = s_1, T_2 = s_2 - s_1, \dots, T_n = s_{n} - s_{n-1}\)</span>, and that the <span class="math inline">\((n+1)^\text{th}\)</span> interarrival time must satisfy <span class="math inline">\(T_{n+1} &gt; t - s_n\)</span>.</p>
<p>Then, we have <span class="math display">\[
\begin{aligned}
    f_{S_1, \dots, S_n \mid N_t} (s_1, \dots, s_n \mid N_t = n) &amp; =
        \frac{f_{S_1, \dots, S_n, N_t}(s_1, \dots, s_n, n)}{\Pr(N_t = n)} &amp;&amp; \text{(a)}\\
    &amp; = \frac{f_{T_1}(s_1) f_{T_2}(s_2 - s_1) \dots f_{T_n}(s_{n} - s_{n-1}) \Pr(T_{n+1} &gt; t - s_n)}
        {\Pr(N_t = n)}, &amp;&amp; \text{(b)}
\end{aligned}
\]</span> where (a) comes from the definition of conditional probability, and (b) translates the statement in terms of interarrival times.<br>
</p>
<p>The <span class="math inline">\(f_{T_i}\)</span> are given by the probability density of the exponential distribution, <span class="math inline">\(\Pr(T_{n+1} &gt; t - s_n)\)</span> is obtained from the cumulative distribution function of the exponential distribution, and <span class="math inline">\(\Pr(N_t = n)\)</span> is the probability mass function of a Poisson distribution. Making these substitutions, we find <span class="math display">\[
\begin{aligned}
    f_{S_1, \dots, S_n} (s_1, \dots, s_n \mid N_t = n) &amp; = \frac{\lambda e^{-\lambda s_1} \lambda e^{-\lambda (s_2 - s_1)} \dots \lambda e^{-\lambda(s_{n} - s_{n-1})} e^{-\lambda(t - s_n)}}{(\lambda t)^n e^{-\lambda t} / n!}\\
    &amp; = \frac{\lambda^n \exp(\lambda (s_1 - s_1 + s_2 - s_2 + \dots + s_n - s_n - t))}{\lambda^n t^n \exp(-\lambda t) / n!} \\
    &amp; = \frac{\lambda^n e^{-\lambda t}}{ \lambda^n e^{-\lambda t} t^n / n!} \\
    &amp; = \frac{n!}{t^n},
\end{aligned}
\]</span> as required.</p>
</div>
</div>
</div>
<p>Another way to state the proposition above is that the arrival times, considered as unordered random variables, are uniformly distributed conditionally on the number of events in <span class="math inline">\((0, t)\)</span>. Note that we cannot state that the distribution of event times is therefore uniform over <span class="math inline">\([0, \infty)\)</span>, because the uniform distribution is only well defined over bounded intervals.</p>
<p>This result suggests an alternative method to simulate from a Poisson process:</p>
<ol type="1">
<li><p>set <span class="math inline">\(t\)</span>, and simulate <span class="math inline">\(N_t \sim \text{Poisson}(\lambda t)\)</span>;</p></li>
<li><p>simulate <span class="math inline">\(U_1, U_2, \dots, U_{N_{t}} \sim \text{Unif}(0, t)\)</span>;</p></li>
<li><p>define the arrival times as <span class="math inline">\(S_i = U_{(i)}\)</span>, where <span class="math inline">\(U_{(i)}\)</span> is the <span class="math inline">\(i^\text{th}\)</span> smallest value in <span class="math inline">\(\{ U_1, \dots, U_n \}\)</span>;</p></li>
<li><p>let <span class="math inline">\(N_s = n - 1\)</span> over <span class="math inline">\(S_{n-1} \leq s &lt; S_n\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Assume that the occurrence of major earthquakes in Canada since January 1, 2000 can be described by a Poisson process with rate <span class="math inline">\(\lambda = 1\)</span> per year.<br>
</p>
<ol type="1">
<li><p>Find the probability that the 20th major earthquake since January 1, 2000 occurred in 2022.<br>
</p>
<p>The arrival time of the 20th earthquake, <span class="math inline">\(S_{20}\)</span>, follows a gamma distribution with shape 20 and with rate 1 (where January 1, 2000 is treated as <span class="math inline">\(t = 0\)</span>). We want the probability <span class="math display">\[
     \begin{aligned}
     \Pr(22 &lt; S_{20} &lt; 23) &amp; = \Pr(S_{20} &lt; 23) - \Pr(S_{20} &lt; 22) \\
     &amp; = 0.762 - 0.694 \\
     &amp; = 0.068
     \end{aligned}
\]</span> using the cumulative distribution function of the gamma distribution (e.g., <code>pgamma()</code> in R).<br>
</p></li>
<li><p>Given that 20 major earthquakes took place in Canada between January 1, 2000 and December 31, 2022, what is the probability that the 20th earthquake occurred in 2022?<br>
</p>
<p>We want the probability that the last earthquake took place in 2022, i.e., that the maximum of 20 random variables from Unif<span class="math inline">\((0, 23)\)</span> is greater than 22. Let <span class="math inline">\(U_1, U_2, \dots, U_{20}\)</span> be Unif<span class="math inline">\((0, 23)\)</span> random variables, and let <span class="math inline">\(M\)</span> be their maximum. We can get the conditional probability as follows, <span class="math display">\[
     \begin{aligned}
     \Pr(22 &lt; S_{20} &lt; 23 \mid N_{23} = 20) &amp; = \Pr(22 &lt; M &lt; 23) \\
         &amp; = 1 - \Pr(M \leq 22) \\
         &amp; = 1 - \Pr(U_1 \leq 22, U_2 \leq 22, \dots, U_{20} \leq 22) \\
         &amp; = 1 - \Pr(U_1 \leq 22) \Pr(U_2 \leq 22) \cdots \Pr(U_{20} \leq 22) \\
         &amp; = 1 - \Pr(U_1 \leq 22)^{20} \\
         &amp; = 1 - (22/23)^{20} \\
         &amp; = 1 - 0.411 \\
         &amp; = 0.589
     \end{aligned}
\]</span></p></li>
</ol>
<p>Notably, the answers to questions 1 and 2 are different.</p>
</div>
</div>
</div>
<!-- =========================================== -->
<!-- ================= SECTION ================= -->
<!-- =========================================== -->
</section>
</section>
<section id="statistical-inference" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="statistical-inference"><span class="header-section-number">3.4</span> Statistical inference</h2>
<p>Given a sequence of event times <span class="math inline">\((S_1, \dots, S_N)\)</span>, we want to estimate the rate parameter <span class="math inline">\(\lambda\)</span> of the Poisson process. The simplest way to do this is to use the distribution of interarrival times to derive the likelihood, and optimise it with respect to <span class="math inline">\(\lambda\)</span>.</p>
<p>For <span class="math inline">\(n = 1, \dots, N\)</span>, the interarrival times <span class="math inline">\(T_n = S_{n} - S_{n-1}\)</span> arise from an exponential distribution with rate parameter <span class="math inline">\(\lambda\)</span> (where we define <span class="math inline">\(S_0 = 0\)</span>). The likelihood function is therefore <span class="math display">\[
    L(\lambda) = \prod_{n=1}^N \lambda e^{-\lambda T_n},
\]</span> and the log-likelihood is <span class="math display">\[
    \ell(\lambda) = \sum_{n=1}^N ( \log(\lambda) - \lambda T_n )
    = N \log(\lambda) - \lambda \sum_{n=1}^N T_n.
\]</span></p>
<p>To find the maximum likelihood estimator, we differentiate the log-likelihood with respect to <span class="math inline">\(\lambda\)</span> and we set to zero: <span class="math display">\[
\begin{aligned}
    \frac{\partial \ell}{\partial \lambda} (\widehat\lambda) = 0
    &amp; \Rightarrow  \frac{N}{\widehat\lambda} - \sum_{n=1}^N T_n = 0 \\
    &amp; \Rightarrow \widehat\lambda = \frac{N}{\sum_{n=1}^N T_n} \\
    &amp; \Rightarrow \widehat\lambda = \frac{N}{S_N}.
\end{aligned}
\]</span></p>
<p>This result is intuitive: our best guess for the rate of the process (i.e., expected number of events per unit time) is the number of observed events over the length of the period of observation.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.4
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The Old Faithful is a geyser in the Yellowstone National Park, Wyoming, USA, which erupts at very predictable intervals. The data set of eruption times and inter-eruption intervals is a classic example used to illustrate time series and point process models. It is automatically loaded in R as the <code>faithful</code> data object; it has one column for durations of eruptions, and one column for inter-eruption waiting times (i.e., interarrival times). Here, we are interested in the latter.<br>
</p>
<ol type="1">
<li><p>Assuming that the eruptions of the Old Faithful geyser can be described as a Poisson process, what is maximum likelihood estimate of the eruption rate?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"faithful"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(faithful)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  eruptions waiting
1     3.600      79
2     1.800      54
3     3.333      74
4     2.283      62
5     4.533      85
6     2.883      55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute MLE of rate</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">nrow</span>(faithful) <span class="sc">/</span> <span class="fu">sum</span>(faithful<span class="sc">$</span>waiting)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01410496</code></pre>
</div>
</div>
<p>The estimated rate is <span class="math inline">\(\widehat\lambda = 0.014\)</span> eruptions per minutes. That is, the estimated mean waiting time between eruptions is <span class="math inline">\(1 / 0.014 = 70.9\)</span> min (which is just the average of the <code>waiting</code> column of the data frame).<br>
</p></li>
<li><p>What is the probability that more than 30 eruptions take place on a given day?<br>
</p>
<p>The number of eruptions during a day follows a Poisson distribution with rate <span class="math inline">\(\lambda (24 \times 60)\)</span>, i.e., the rate parameter multiplied by the number of minutes in a day. The probability is <span class="math display">\[
\begin{aligned}
    \Pr(N &gt; 30) &amp; = 1 - \Pr(N \leq 30) \\
    &amp; = 1 - 0.984 \\
    &amp; = 0.016,
\end{aligned}
\]</span> using the cumulative distribution function of the Poisson distribution.</p></li>
</ol>
</div>
</div>
</div>
<!-- =========================================== -->
<!-- ================= SECTION ================= -->
<!-- =========================================== -->
</section>
<section id="non-homogeneous-poisson-process" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="non-homogeneous-poisson-process"><span class="header-section-number">3.5</span> Non-homogeneous Poisson process</h2>
<p>In many applications, the rate of events is not constant through time. For example, hurricanes on the East coast of North America are more common in the summer months, and arrivals of customers at a restaurant are more frequent around lunch and dinner. This phenomenon can be modelled with the non-homogeneous Poisson process, an extension of the Poisson process where the rate depends on time. We call the time-varying rate <span class="math inline">\(\lambda(t)\)</span> the intensity function of the process.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition 3.8
</div>
</div>
<div class="callout-body-container callout-body">
<p>A counting process <span class="math inline">\((N_t)_{t \geq 0}\)</span> is a <strong>non-homogeneous Poisson process</strong> with intensity function <span class="math inline">\(\lambda(t)\)</span> if</p>
<ol type="1">
<li><p><span class="math inline">\(N_0 = 0\)</span></p></li>
<li><p>for all <span class="math inline">\(t &gt; 0\)</span>, <span class="math inline">\(N_t\)</span> has a Poisson distribution with mean <span class="math display">\[
E[N_t] = \int_{0}^t \lambda(s)\ ds;
\]</span></p></li>
<li><p><span class="math inline">\((N_t)\)</span> has independent increments.</p></li>
</ol>
</div>
</div>
<p>The Poisson process is a special case where <span class="math inline">\(\lambda(t) = \lambda\)</span> is constant through time. Note that the non-homogeneous Poisson process does not generally have stationary increments, because the distribution of an increment depends on <span class="math inline">\(\lambda(t)\)</span>. For this reason, it is also sometimes called the non-stationary Poisson process.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.5
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\((N_t)\)</span> is a non-homogeneous Poisson process with intensity function <span class="math inline">\(\lambda(t)\)</span>, then, for <span class="math inline">\(0 &lt; s &lt; t\)</span>, we have <span class="math display">\[
    N_t - N_s \sim \text{Poisson} \left( \int_s^t \lambda(x)\ dx \right).
\]</span></p>
<p>That is, the number of events that occur between <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> follows a Poisson distribution, with rate the integral of the intensity function over that interval.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof (sketch)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We know that if <span class="math inline">\(X \sim \text{Poisson}(\lambda_1)\)</span> and <span class="math inline">\(Y \sim \text{Poisson}(\lambda_2)\)</span> are independent, then <span class="math inline">\(Z = X+Y\)</span> also follows a Poisson distribution, with rate <span class="math inline">\(\lambda_1 + \lambda_2\)</span> (proof in appendix).</p>
<p>From the definition of a non-homogeneous Poisson process we have</p>
<ul>
<li><p><span class="math inline">\(N_s \sim \text{Poisson}(\int_0^s \lambda(x)\ dx)\)</span></p></li>
<li><p><span class="math inline">\(N_t \sim \text{Poisson}(\int_0^t \lambda(x)\ dx)\)</span></p></li>
<li><p><span class="math inline">\(N_s\)</span> and <span class="math inline">\(N_t - N_s\)</span> are independent</p></li>
</ul>
<p>Knowing that <span class="math inline">\(N_s\)</span> and <span class="math inline">\(N_t = (N_s + (N_t - N_s))\)</span> both have Poisson distributions, we infer that <span class="math inline">\(N_t - N_s\)</span> also has a Poisson distribution, with rate <span class="math display">\[
\begin{aligned}
    E[N_t - N_s] = &amp; E[N_t] - E[N_s] \\
    &amp; = \int_0^t \lambda(x)\ dx - \int_0^s \lambda(x)\ dx \\
    &amp; = \int_s^t \lambda(x)\ dx
\end{aligned}
\]</span></p>
</div>
</div>
</div>
<p>This result tells us that more events will take place over time intervals where the intensity function is high. This is illustrated with an example in <a href="#fig-nonhomogeneous-sim" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-nonhomogeneous-sim</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nonhomogeneous-sim" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nonhomogeneous-sim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-nonhomogeneous-sim-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nonhomogeneous-sim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.8: Example of intensity function <span class="math inline">\(\lambda(x)\)</span> (black line), and simulated event times from the corresponding non-homogeneous Poisson process (red vertical ticks).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.5
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Assume that 911 calls in a city arrive with a rate that depends on the time of day, and can be modelled with a non-homogeneous Poisson process. The call rate, in calls per hour, is approximately described by the function <span class="math display">\[
    \lambda(x) = -40 \cos \left( \frac{\pi (x - 5)}{12} \right) + 60
\]</span> where <span class="math inline">\(x \in [0, 24)\)</span> is the time of day. The rate function is shown in <a href="#fig-nonhomog-example" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-nonhomog-example</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nonhomog-example" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nonhomog-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-nonhomog-example-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nonhomog-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.9: Intensity function <span class="math inline">\(\lambda(x)\)</span> in example
</figcaption>
</figure>
</div>
</div>
</div>
<p>What is the expected number of calls between 5pm and 8pm on a given day?</p>
<p><span class="math display">\[
\begin{aligned}
    E[N_{20} - N_{17}] &amp; = \int_{17}^{20} \lambda(x)\ dx \\
        &amp; = 180 - 40 \int_{17}^{20} \cos \left( \frac{\pi}{12} x - \frac{5 \pi}{12} \right)\ dx \\
        &amp; = 180 - 40 \left[ \frac{12}{\pi} \sin \left( \frac{\pi}{12} x - \frac{5 \pi}{12} \right) \right] \bigg\rvert_{x = 17}^{20} \\
        &amp; = 288
\end{aligned}
\]</span></p>
</div>
</div>
</div>
<!-- =========================================== -->
<!-- ================= SECTION ================= -->
<!-- =========================================== -->
</section>
<section id="merging-and-splitting-poisson-processes" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="merging-and-splitting-poisson-processes"><span class="header-section-number">3.6</span> Merging and splitting Poisson processes</h2>
<!-- See Lam's notes -->
<section id="merging-poisson-processes" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="merging-poisson-processes"><span class="header-section-number">3.6.1</span> Merging Poisson processes</h3>
<!-- - merging process is also called superposition process (e.g., Dubrow) -->
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.6
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\((N_{t}^{(1)}), (N_{t}^{(2)}), \dots, (N_{t}^{(m)})\)</span> be <span class="math inline">\(m\)</span> independent Poisson processes with rates <span class="math inline">\(\lambda_1, \dots, \lambda_m\)</span>, respectively. The process <span class="math inline">\((N_t)\)</span> defined by <span class="math display">\[
    N_t = N_{t}^{(1)} + N_{t}^{(2)} +\dots + N_{t}^{(m)},\quad \text{for all } t \geq 0
\]</span> is a Poisson process with rate <span class="math inline">\(\lambda_1 + \lambda_2 + \dots + \lambda_m\)</span>.</p>
</div>
</div>
<!-- Norris instead proves this using the infinitesimal definition -->
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider the case <span class="math inline">\(m = 2\)</span>, i.e., <span class="math inline">\(N_t = N_t^{(1)} + N_t^{(2)}\)</span> where <span class="math inline">\((N_{t}^{(1)})\)</span> and <span class="math inline">\((N_{t}^{(2)})\)</span> are independent Poisson processes. We need to check that <span class="math inline">\((N_t)\)</span> satisfies the three conditions outlined in the definition of a Poisson process.</p>
<ol type="1">
<li><p><span class="math inline">\(N_0 = N_0^{(1)} + N_0^{(2)} = 0 + 0 = 0\)</span></p></li>
<li><p><span class="math inline">\((N_{t}^{(1)})\)</span> and <span class="math inline">\((N_{t}^{(2)})\)</span> are independent and have independent increments, so <span class="math inline">\((N_t)\)</span> has independent increments. Likewise, <span class="math inline">\((N_{t}^{(1)})\)</span> and <span class="math inline">\((N_{t}^{(2)})\)</span> have stationary increments so <span class="math inline">\((N_t)\)</span> does too.</p></li>
<li><p>If <span class="math inline">\(X \sim \text{Poisson}(\lambda_1)\)</span> and <span class="math inline">\(Y \sim \text{Poisson}(\lambda_2)\)</span> are independent, then <span class="math inline">\(X+Y \sim \text{Poisson}(\lambda_1 + \lambda_2)\)</span> (proof in appendix). This implies <span class="math display">\[
N_t = N_t^{(1)} + N_t^{(2)} \sim \text{Poisson}((\lambda_1 + \lambda_2) t)
\]</span></p></li>
</ol>
<p>In conclusion, <span class="math inline">\((N_t)\)</span> is a Poisson process with rate <span class="math inline">\(\lambba_1 + \lambda_2\)</span>.</p>
</div>
</div>
</div>
<p><a href="#fig-pois-merge" class="quarto-xref">Figure&nbsp;<span class="quarto-unresolved-ref">fig-pois-merge</span></a> shows an example of a process constructed by merging two Poisson processes.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pois-merge" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pois-merge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03_poisson_files/figure-html/fig-pois-merge-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pois-merge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.10: Event times for three Poisson processes, where <span class="math inline">\((N_t)\)</span> is the process defined by <span class="math inline">\(N_t = N_t^{(1)} + N_t^{(2)}\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.6
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider a soccer game between teams A and B, and assume that goals scored by the teams can be modelled with two Poisson process, with rates <span class="math inline">\(\lambda_A = 1.1\)</span> and <span class="math inline">\(\lambda_B = 1.4\)</span> (goals per hour), respectively.<br>
</p>
<ol type="1">
<li><p>What is the probability that no goals have been scored by the end of the game, i.e., after 90 minutes?<br>
</p>
<p>Let $N_t^{(A)} and <span class="math inline">\(N_t^{(B)}\)</span> be the number of goals by teams A and B (respectively), and <span class="math inline">\(N_t = N_t^{(A)} + N_t^{(B)}\)</span> be the total number of goals scored by both teams. <span class="math inline">\((N_t)\)</span> is a Poisson process with rate <span class="math inline">\(\lambda = 1.1 + 1.4 = 2.5\)</span>. In particular, the number of goals scored after 90 minutes (= 1.5 hour) follows a Poisson distribution with rate <span class="math inline">\(1.5 \times 2.5 = 3.75\)</span>, so the required probability is <span class="math display">\[
     \Pr(N_{1.5} = 0) = \frac{3.75^0 \times e^{-3.75}}{0!} = e^{-3.75} = 0.024,
\]</span> so there is a 2.4% probability that zero goals will be scored during the game.<br>
</p></li>
<li><p>What is the probability that team B wins? <span class="math display">\[
\begin{aligned}
     \Pr(N_T^{(A)} &lt; N_T^{(B)}) &amp; = \sum_{n = 0}^\infty \sum_{k = 1}^\infty \Pr(N_T^{(A)} = n, N_T^{(B)} = n + k) \\
         &amp; = \sum_{n = 0}^\infty \sum_{k = 1}^\infty \Pr(N_T^{(A)} = n) \Pr(N_T^{(B)} = n + k) \\
         &amp; = \sum_{n = 0}^\infty \sum_{k = 1}^\infty
             \frac{(\lambda_A T)^{n}}{(n)!} e^{-\lambda_A T}
             \frac{(\lambda_B T)^{n+k}}{(n+k)!} e^{-\lambda_B T}.
\end{aligned}
\]</span> We substitute <span class="math inline">\(\lambda_A = 1.1\)</span>, <span class="math inline">\(\lambda_B = 1.4\)</span> and <span class="math inline">\(T = 1.5\)</span>, and use a computer to find <span class="math display">\[
\Pr(N_{1.5}^{(A)} &lt; N_{1.5}^{(B)}) \approx 0.316.
\]</span></p>
<p>You should think about how you would use R to compute an approximation of the series above.</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="splitting-a-poisson-process" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="splitting-a-poisson-process"><span class="header-section-number">3.6.2</span> Splitting a Poisson process</h3>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition 3.7
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\((N_t)\)</span> be a Poisson process with rate <span class="math inline">\(\lambda\)</span>. Assume that each event is marked as a “type <span class="math inline">\(k\)</span>” event with probability <span class="math inline">\(p_k\)</span> for <span class="math inline">\(k = 1, \dots, K\)</span>, where <span class="math inline">\(p_1 +\dots + p_K = 1\)</span>. Let <span class="math inline">\(N_t^{(k)}\)</span> be the number of events of type <span class="math inline">\(k\)</span> in <span class="math inline">\([0, t]\)</span>. Then, the processes <span class="math inline">\((N_t^{(1)}), \dots, (N_t^{(K)})\)</span> are independent Poisson processes with rates <span class="math inline">\(\lambda p_1, \dots, \lambda p_K\)</span>, respectively.</p>
</div>
</div>
<!-- From Dobrow (p 238) -->
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will prove the result for the case of <span class="math inline">\(K = 2\)</span> groups. Let <span class="math inline">\(N_t\)</span>, <span class="math inline">\(N_t^{(1)}\)</span> and <span class="math inline">\(N_t^{(2)}\)</span> be as defined above.</p>
<p><span class="math display">\[
\begin{aligned}
    \Pr(N_t^{(1)} = n_1, N_t^{(2)} = n_2) &amp; = \Pr(N_t^{(1)} = n_1, N_t^{(2)} = n_2, N_t = n_1 + n_2) \\
    &amp; = \Pr(N_t^{(1)} = n_1, N_t^{(2)} = n_2 \mid N_t = n_1 + n_2) \Pr(N_t = n_1 + n_2) \\
    &amp; = \Pr(N_t^{(1)} = n_1 \mid N_t = n_1 + n_2) \Pr(N_t = n_1 + n_2)
\end{aligned}
\]</span></p>
<p>We know that <span class="math inline">\(N_t^{(1)} \mid N_t \sim \text{Binomial}(n_1 + n_2, p_1)\)</span> and <span class="math inline">\(N_t \sim \text{Poisson}(\lambda t)\)</span>, so we substitute the probability mass functions: <span class="math display">\[
\begin{aligned}
    \Pr(N_t^{(1)} = n_1, N_t^{(2)} = n_2) &amp; = \frac{(n_1 + n_2)!}{n_1! n_2!} p_1^{n_1} p_2^{n_2} \times \frac{e^{-\lambda t} (\lambda t)^{n_1 + n_2}}{(n_1 + n_2) !} \\
    &amp; = \frac{p_1^{n_1} p_2^{n_2} e^{-\lambda t (p_1 + p_2)} (\lambda t)^{n_1 + n_2}}{n_1! n_2!} \\
    &amp; = \frac{e^{-\lambda t p_1} (\lambda t p_1)^{n_1}}{n_1 !} \frac{e^{-\lambda t p_2} (\lambda t p_2)^{n_2}}{n_2!}
\end{aligned}
\]</span> This is the product of the probability mass functions of Poisson(<span class="math inline">\(\lambda p_1 t\)</span>) and Poisson(<span class="math inline">\(\lambda p_2 t\)</span>), so <span class="math inline">\(N_t^{(1)}\)</span> and <span class="math inline">\(N_t^{(2)}\)</span> are independent and follow these distributions, respectively.</p>
</div>
</div>
</div>
<p>Each component process <span class="math inline">\((N_t^{(k)})\)</span> is called a <strong>thinned Poisson process</strong>, because it represents a “thinned” sequence of events, where events are included and excluded with some probability. Thinned Poisson processes are often used in contexts where the process of interest is only observed partially, with some detection probability associated with each event.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example 3.7
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We are interested in the frequency of Northern lights in Churchill, Manitoba. We set up an instrument to record them, but it only works during the night and when the sky is clear. Over the course of a year, it is on average dark enough for the detector to work 40% of the time, and the sky is clear around 60% of the time.<br>
</p>
<ol type="1">
<li><p>How can we model the sequence of recorded Northern lights with a Poisson process?<br>
</p>
<p>We assume that the number of Northern lights follows a Poisson process with rate <span class="math inline">\(\lambda\)</span> (in events per year). Each event is either observed or not, with some probability, so the recorded Northern lights follow a thinned Poisson process. The detection probability is <span class="math inline">\(0.4 \times 0.6 = 0.24\)</span>, so the rate of the thinned process is <span class="math inline">\(\lambda_\text{thin} = 0.24 \lambda\)</span>. That is, there is a 24% probability of detecting a given Northern light with the instrument.<br>
</p></li>
<li><p>The detector recorded 27 Northern lights last year. Estimate the rate of Northern lights in Churchill.<br>
</p>
<p>The number of <em>recorded</em> events gives us an estimate of the rate of the thinned process, <span class="math inline">\(\widehat\lambda_\text{thin} = 27 / 1 = 27\)</span>. We are interested in the rate of the non-thinned process, though, and we can calculate the estimate as <span class="math inline">\(\widehat\lambda = \widehat\lambda_\text{thin} / 0.24 = 112.5\)</span>. We estimate that the rate of Northern lights in Churchill is 112.5 per year.</p></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="problems" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="problems"><span class="header-section-number">3.7</span> Problems</h2>
<ol type="1">
<li><p>You receive spam emails at an average rate of 5 per week, and you decide to model this using a Poisson process.</p>
<ol type="a">
<li><p>What is the probability that you receive strictly more than 2 spam emails during the first week (i.e., the first 7 days) of November?</p></li>
<li><p>What is the probability that you receive exactly 5 emails during the first 6 days of November, given that you received 3 spam emails during the first 3 days of November?</p></li>
<li><p>What is the probability that you received exactly 3 emails during the first 3 days of November, given that you received 5 spam emails during the first 6 days of November?</p></li>
</ol></li>
<li><p>Assume that the occurrence of thunderstorms in Halifax follows a Poisson process with rate <span class="math inline">\(\lambda = 0.3\)</span> per day. All times in this question are expressed in units of days, where <span class="math inline">\(t = 0\)</span> is some arbitrary start date. <em>Using the rules of probability</em>, we want to find the probability that 2 thunderstorms occur between <span class="math inline">\(t = 3\)</span> and <span class="math inline">\(t = 10\)</span>, given that 2 thunderstorms have occurred between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t = 5\)</span>.</p>
<ol type="a">
<li><p>Consider the three non-overlapping intervals <span class="math inline">\([0, 3]\)</span>, <span class="math inline">\([3, 5]\)</span>, and <span class="math inline">\([5, 10]\)</span>. If 2 thunderstorms occurred between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t = 5\)</span>, how many thunderstorms could occur in each of these three intervals, in such a way that 2 thunderstorms occur between <span class="math inline">\(t = 3\)</span> and <span class="math inline">\(t = 10\)</span>. List all possible combinations.</p></li>
<li><p>Use the law of total probability to sum over all possible combinations and derive the desired probability. You might also need to use Bayes’ rule.</p></li>
</ol></li>
<li><p>Assume that the occurrence of thunderstorms in Halifax follows a Poisson process with rate <span class="math inline">\(\lambda = 0.3\)</span> per day. All times in this question are expressed in units of days, where <span class="math inline">\(t = 0\)</span> is some arbitrary start date. <em>Using computer simulations</em>, we want to estimate the probability that 2 thunderstorms occur between <span class="math inline">\(t = 3\)</span> and <span class="math inline">\(t = 10\)</span>, given that 2 thunderstorms have occurred between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t = 5\)</span>.</p>
<ol type="a">
<li><p>Write a short R function to simulate from a Poisson process, which takes as inputs <code>tmax</code> (the end time of the simulation) and <code>rate</code> (the rate of the process). It should return a vector of arrival times (which should be between 0 and <code>tmax</code>).</p></li>
<li><p>Simulate 10,000 realisations from the thunderstorm Poisson process between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t = 10\)</span>, and store them in a <code>list</code> object.</p></li>
<li><p>Only keep the realisations that satisfy the given condition, i.e., for which 2 thunderstorms occured between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t = 5\)</span>.</p></li>
<li><p>Use the remaining realisations to compute an estimate of the desired probability.</p></li>
</ol></li>
<li><p>In a game of hockey, the process of scoring a goal has two steps: first the players must create a <em>scoring opportunity</em> (i.e., a situation where they have a good chance of scoring), and then they must <em>convert</em> this opportunity (i.e., actually score a goal).</p>
<p>We assume that the occurrence of scoring opportunities for the two teams follow independent Poisson processes, with rates <span class="math inline">\(\lambda_A &gt; 0\)</span> for team A and <span class="math inline">\(\lambda_B &gt; 0\)</span> for team B (measured in opportunities per minute). We also assume that whether each opportunity is converted happens at random (and independently of other opportunities), with probability <span class="math inline">\(p_A \in (0, 1)\)</span> for team A and <span class="math inline">\(p_B \in (0, 1)\)</span> for team B.</p>
<p>In the following, remember that a hockey game lasts 60 minutes in total, split into three 20-minute periods.</p>
<ol type="a">
<li><p>Let <span class="math inline">\(N_t\)</span> be the total number of goals scored in the game, by both teams, up to time <span class="math inline">\(t \in [0, 60]\)</span>. What do you know about the process <span class="math inline">\((N_t)\)</span>?</p></li>
<li><p>What is the expected number of goals scored during a game (i.e., over 60 minutes), written in terms of <span class="math inline">\(\lambda_A\)</span>, <span class="math inline">\(\lambda_B\)</span>, <span class="math inline">\(p_A\)</span> and <span class="math inline">\(p_B\)</span>?</p></li>
<li><p>In the absence of any other information, how would you compute the probability that the third goal of the game is scored during the first period (i.e., during the first 20 minutes)? You don’t need to write the formula explicitly, but your reasoning should be clear (e.g., you can define a symbol to represent a distribution function if needed, rather than write out its full expression).</p></li>
<li><p>We now find out that exactly two goals were scored during the first 15 minutes of the game. Given this information, how would you compute the probability that the third goal of the game is scored during the first period?</p></li>
<li><p>If your answers to questions c and d are different, write a few sentences to explain why this is the case to a non-mathematician.</p></li>
<li><p>We use data from the 2022–2023 season to apply this model to the Edmonton Oilers (Team A) and the Toronto Maple Leafs (Team B):</p>
<ul>
<li>Edmonton had an average of 33.6 opportunities and 4 goals per game;</li>
<li>Toronto had an average of 32 opportunities and 3.4 goals per game. Give estimates of <span class="math inline">\(\lambda_A\)</span>, <span class="math inline">\(\lambda_B\)</span>, <span class="math inline">\(p_A\)</span> and <span class="math inline">\(p_B\)</span>.</li>
</ul></li>
<li><p>The two teams played a game on March 11, 2023. Given that Edmonton had exactly 26 opportunities during the game, what is the probability that they scored exactly 5 goals? Use the estimated parameters from question f where necessary.</p></li>
</ol></li>
<li><p>We consider a bar that opens every day between 5pm and 10pm. We assume that customers arrive following a non-homogeneous Poisson process. Specifically, the average rate of arrivals (per hour) at time <span class="math inline">\(t\)</span> is given by the function <span class="math display">\[
  \lambda(t) =
  \begin{cases}
25 t - 125 &amp; \text{if } 5 \leq t &lt; 7, \\
50 &amp; \text{if } 7 \leq t &lt; 8, \\
-30 t + 290 &amp; \text{if } 8 \leq t &lt; 9, \\
20 &amp; \text{if } 9 \leq t &lt; 10, \\
0 &amp; \text{otherwise.}
  \end{cases}
\]</span> Here, <span class="math inline">\(t\)</span> is measured in hours post-midday (e.g., <span class="math inline">\(t = 7\)</span> corresponds to 7pm).</p>
<ol type="a">
<li><p>What is the expected number of customers arriving between 7:30pm and 8:30pm?</p></li>
<li><p>What is the probability that at least 45 customers arrive between 5pm and 7pm, given that exactly 10 customers arrived between 5pm and 6pm?</p></li>
<li><p>The bar manager considers changing the business model to try to increase the overall number of customers. Their proposed plan would cause the customer arrival rate to be constant and equal to 30 between 5pm and 10pm (and still zero elsewhere). Should they implement this new plan?</p></li>
</ol></li>
<li><p>We want to simulate arrival times from a non-homogeneous Poisson process with rate function <span class="math inline">\(\lambda(t) = \exp[2\cos(\frac{2 \pi t}{5})] + \frac{t}{2}\)</span> between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t =10\)</span>, using the following procedure.</p>
<p>First, we simulate a realisation from the Poisson process with rate <span class="math inline">\(\lambda^*\)</span>, where <span class="math inline">\(\lambda^* = \max_{t \in [0, 10]} \{ \lambda(t) \}\)</span>. Let <span class="math inline">\(S_1^*, S_2^*, \dots\)</span> be the arrival times for this process. Then, we keep the <span class="math inline">\(k\)</span>-th arrival time <span class="math inline">\(S_k^*\)</span> with probability <span class="math inline">\(\frac{\lambda(S_k^*)}{\lambda^*}\)</span>. This procedure is called “thinning”, and the arrival times that we keep are a realisation from the non-homogeneous Poisson process.</p>
<p>Use R to answer the following questions.</p>
<ol type="a">
<li><p>Plot the function <span class="math inline">\(\lambda\)</span> between <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t = 10\)</span>. Use this graph to determine the value of <span class="math inline">\(t \in [0, 10]\)</span> for which the function reaches its maximum (over this interval). Calculate <span class="math inline">\(\lambda^*\)</span>. </p></li>
<li><p>Generate a realisation from the Poisson process with rate <span class="math inline">\(\lambda^*\)</span> over <span class="math inline">\(t \in [0, 10]\)</span>, using the functions <code>rpois()</code> and <code>runif()</code>.</p></li>
<li><p>Thin the realisation, i.e., decide whether or not to keep each arrival time based on the procedure described above. Print the sequence of arrival times that you obtain for the non-homogeneous process.</p></li>
<li><p>Repeat the simulation and thinning steps 1000 times, and use the 1000 realisations to estimate the probability that, under the non-homogeneous Poisson process with rate function <span class="math inline">\(\lambda\)</span>, the number of events between <span class="math inline">\(t = 2\)</span> and <span class="math inline">\(t = 4\)</span> is at least 5.</p></li>
</ol></li>
</ol>
</section>
<section id="appendix-some-proofs" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="appendix-some-proofs">Appendix: some proofs</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proposition
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(X \sim \text{Poisson}(\lambda_1)\)</span> and <span class="math inline">\(Y \sim \text{Poisson}(\lambda_2)\)</span> are independent, then <span class="math inline">\(X+Y \sim \text{Poisson}(\lambda_1 + \lambda_2)\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By the law of total probability, <span class="math display">\[
\begin{aligned}
    \Pr(X+Y = n) &amp; = \sum_{k = 0}^n \Pr(X+Y = k, X = k) \\
    &amp; = \sum_{k = 0}^n \Pr(Y = n - k, X = k) \\
    &amp; = \sum_{k = 0}^n \Pr(Y = n - k) \Pr(X = k) &amp; \text{(a)}\\
    &amp; = \sum_{k = 0}^n \frac{e^{-\lambda_2}\lambda_2^{n-k}}{(n-k)!} \frac{e^{-\lambda_1} \lambda_1^k}{k!}\\
    &amp; = e^{-(\lambda_1+\lambda_2)} \sum_{k=0}^n \frac{n!}{n!} \frac{\lambda_1^k \lambda_2^{n-k}}{k!(n-k)!} \\
    &amp; = \frac{e^{-(\lambda_1+\lambda_2)} }{n!} \sum_{k=0}^n \binom{n}{k} \lambda_1^k \lambda_2^{n-k}
\end{aligned}
\]</span> where (a) uses the independence of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. By the binomial formula, this yields <span class="math display">\[
    \Pr(X+Y = n) = \frac{e^{-(\lambda_1+\lambda_2)} (\lambda_1 + \lambda_2)^n}{n!}
\]</span> and we recognise the probability mass function of Poisson(<span class="math inline">\(\lambda_1 + \lambda_2\)</span>).</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02_markov_discrete.html" class="pagination-link" aria-label="Discrete-time Markov processes">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Discrete-time Markov processes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_markov_continuous.html" class="pagination-link" aria-label="Continuous-time Markov processes">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Continuous-time Markov processes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>